先看题
感觉t1就是考虑每位然后跑个O(n^2) dp？似乎是的
感觉t2是个最短路？边数似乎会爆炸。。也许可以针对特殊的图弄一个特殊的算法。。似乎有两个建模的想法
t3部分分大概是个数据结构？子任务5是关键。。。感觉枚举一个桥之后在它左右查询一发最小值啥的？

这时候似乎t1比较确定。。t2没有太好的想法。。t3比较有想法
趁着脑子清醒。。先想t3

感觉枚举一个之后另外一个可以三分一下？毕竟贡献没那么好算。。
三分的正确性。。。只有一个的时候肯定是对的。。。两个的时候应该也是对的。。。

再去看看t2

考虑能不能让他。。。按照mod p余数分类连啥的。。？似乎不行。。
不对TAT

30000的范围闹咋样。。难道是nsqrt(N)吗。。

woc。。。mod p + nsqrt(N) 这显然是分块吧。。。

如果p>sqrt(n)暴力连

对于<sqrt(n)的p，从每个点连一条边到它、它到每个点。。边权可能为负数。。
似乎这样就是nsqrt(n)的了！然后跑个dij即可！
这。。。。不错哦。。。

开始写啦。。。

淦。。。t1的子任务5还没想。。。不爽。。。
之前以为是a=b=1的sb点。。结果发现只是a=1

没有下界有什么用呢。。。？

还是部分分滚粗吧TAT

到此为止花了1h20min

周五晚上忘记去食堂吃饭了。。TAT 好饿啊。。。
于是。。听说思维能力记忆力等会下降。。来打模拟吧（smg）。。7：37开始的

写t1代码的时候发现。。诶。。似乎f只保存了是否可行。。那可以bitset优化一发啊！
看上去是不是能ac啊。。

要不要对拍呢。。先写完后面的再说吧TAT
如果t1对拍的话。。暴力大概就是dp一下把or的答案设计到状态中？
感觉不比正解好写（雾。。
看起来肉眼检查一发。。正解应该问题不大

t2开始好像想错了诶。。负权怎么跑dij啊。。。还是spfa大法吼吧。。
估计需要小心得判一下无解

这么建图可能有6*10^6的边。。不过算一下空间还是足够的

要不要倒着跑spfa来避免被卡。。？（真的有效吗？）可以一试

妈蛋好多东西之前没考虑。。完蛋了。。
冷静一下。。

似乎最主要的问题是连到sqrtn的怎么算贡献？
正负有绝对值啊TAT。。这怎么玩。。

那只能拆点连单向长度为0的边。。从而保证我连到的点都是小于这个的了。。。
这玩意的复杂度。。？等等！

为啥连长度为0的？连长度为1的不就好啦！这样边的边权不是0就是1.。bfs大法吼啊！

原来如此！bfs的时候大概弄两个队列搞搞就相当于dij。。。
或者只搞一个队列往前加也可以。。不过那样的话就要用循环队列了。。。

好好好好好。。。开心！

nsqrtn个点nsqrtn个边。。
好好好。。

写好代码。。画了一下样例。。发现少考虑了一个情况TAT。。还好没什么大改动。。

就是每个sqrtp层点都要连向底层基础点。。无论有没有狗。。（有狗就连到sqrtp的边）

妈蛋。。好像卡空间啊。。。TAT
没办法。。删掉那些规律性强的边。。这些边手动转移吧。。

先去吃饭TAT
这时候已经9:10了。。。

11:00回来继续搞。。大概只能搞个30min就要睡觉了TAT

11:30了。。不搞啦

洗澡的时候突然有一个脑洞。。记录一下。。
l r表示两个桥。。
如果说三分法是关于一个l的性质。。
我们不妨考虑l向右移动的时候。。显然。。r一定是单调向右的。。
只是最优点要扫一遍才知道。。
这和一类经典的决策单调性dp优化多么相似啊。。。

9:30来搞啦。。先搞掉一个桥的点吧。。。

10:06去休息下。。。 10:22继续